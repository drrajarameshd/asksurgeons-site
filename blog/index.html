---
layout: default
title: Blog
permalink: /blog/
---

<div class="sticky-gap"></div>

<section class="blog-list container post-layout-root" aria-label="All Blog Posts">
  
  <!-- Search form (kept exactly as requested) -->
  <form action="{{ '/search/' | relative_url }}" method="get" role="search" class="search-form">
    <input id="q" name="q" type="search" placeholder="Search diabetes, thyroid, fever…" value="{{ page.q | default: '' }}" class="input" />
    <button class="btn gradient" type="submit">Search</button>
  </form>
  
  <div class="wrap">
    <header class="page-header">
      <h2>Blog Posts</h2>
      <p class="page-description">Browse helpful articles and guides from AskSurgeons.</p>
    </header>

    {%- comment -%}
      Use paginator.posts when pagination is enabled (jekyll-paginate).
      Fallback to listing all non-draft posts if paginator is missing.
    {%- endcomment -%}

    {% assign all_posts = site.posts | where_exp:'p','p.draft != true' | sort: 'date' | reverse %}
    {% if paginator %}
      {% assign posts_to_show = paginator.posts %}
    {% else %}
      {% assign posts_to_show = all_posts %}
    {% endif %}

    {% if posts_to_show == empty %}
      <p>No posts available yet. Add some in <code>_posts/</code>.</p>
    {% else %}
      <!-- postsContainer is the element the JS will append new post-item nodes to -->
      <article id="postsContainer" class="post-list" aria-live="polite">
        {% for post in posts_to_show %}
          <article class="post-item" itemscope itemtype="http://schema.org/BlogPosting">
            {% if post.thumbnail %}
              <a class="thumb" href="{{ post.url | relative_url }}" itemprop="url" aria-hidden="true" tabindex="-1">
                <img src="{{ post.thumbnail | relative_url }}" alt="{{ post.title | escape }}" loading="lazy" width="200" height="120">
              </a>
            {% endif %}

            <div class="post-meta">
              <h3 class="post-link" itemprop="headline">
                <a href="{{ post.url | relative_url }}">{{ post.title }}</a>
              </h3>

              <div class="meta">
                <time datetime="{{ post.date | date_to_xmlschema }}" itemprop="datePublished">
                  {{ post.date | date: "%B %-d, %Y" }}
                </time>

                {% if post.tags and post.tags.size > 0 %}
                  <div class="post-tags">
                    {% for tag in post.tags %}
                      <a class="post-tag" href="{{ '/search/' | relative_url }}?q={{ tag | uri_escape }}">{{ tag }}</a>
                    {% endfor %}
                  </div>
                {% endif %}
              </div>

              {% if post.excerpt %}
                <p class="excerpt" itemprop="description">{{ post.excerpt | strip_html | truncate: 200 }}</p>
              {% endif %}

              <p style="margin-top:.55rem;"><a class="btn outline" href="{{ post.url | relative_url }}">Read more</a></p>
            </div>
          </article>
        {% endfor %}
      </article>
    {% endif %}
  </div>

  <!-- Infinite-scroll loader sentinel (no paginator required) -->
  <div id="infiniteLoader" aria-hidden="true" style="text-align:center;padding:18px;">
    <!-- shown when user prefers reduced motion or auto loading fails -->
    <button id="loadMoreBtn" class="btn muted" style="display:none;">Load more</button>

    <!-- spinner -->
    <div id="loaderSpinner" style="display:none;margin:8px auto;" aria-hidden="true">
      <svg width="28" height="28" viewBox="0 0 50 50" aria-hidden="true">
        <circle cx="25" cy="25" r="20" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round" stroke-dasharray="31.4 31.4" transform="rotate(-90 25 25)">
          <animateTransform attributeName="transform" type="rotate" values="-90 25 25;270 25 25" dur="0.9s" repeatCount="indefinite" />
        </circle>
      </svg>
    </div>

    <div id="endOfList" style="display:none;color:var(--muted);margin-top:6px;">No more posts</div>
  </div>

  {%- comment -%} If you still have paginator enabled for other reasons, keep controls; they won't be used by the JS. {%- endcomment -%}
  {% if paginator and paginator.total_pages > 1 %}
    <nav class="pagination" role="navigation" aria-label="Pagination">
      {% assign current = paginator.page | default: 1 %}
      {% assign total = paginator.total_pages %}

      {% if paginator.previous_page %}
        {% if paginator.previous_page == 1 %}
          <a class="btn" href="{{ '/blog/' | relative_url }}" aria-label="Newer posts">← Newer</a>
        {% else %}
          <a class="btn" href="{{ paginator.previous_page_path | relative_url }}" aria-label="Newer posts">← Newer</a>
        {% endif %}
      {% else %}
        <span class="btn is-disabled" aria-disabled="true">← Newer</span>
      {% endif %}

      <span aria-hidden="true" style="margin:0 .5rem;color:var(--muted)">Page {{ current }} of {{ total }}</span>

      {% if paginator.next_page %}
        <a class="btn" href="{{ paginator.next_page_path | relative_url }}" aria-label="Older posts">Older →</a>
      {% else %}
        <span class="btn is-disabled" aria-disabled="true">Older →</span>
      {% endif %}
    </nav>
  {% endif %}

</section>

<!-- include the infinite-scroll script adapted for search-pages -->
<script src="{{ '/assets/js/infinite-scroll-search-pages.js' | relative_url }}" defer
  data-base-pattern="{{ '/search-pages/search-{{page}}.json' | relative_url }}"
  data-start-page="2"
  data-batch-size="10"></script>
