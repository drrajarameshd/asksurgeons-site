{%- assign _id = include.id | to_s -%}
{%- assign d = site.data.doctors | where: "id", _id | first -%}

{%- if d -%}
  {%- assign img = d.image | default: '/assets/images/site-images/doctor-placeholder.webp' | relative_url -%}

  {%- assign degree_text = d.degree -%}
  {%- if d.degree and d.degree.first -%}
    {%- assign degree_text = d.degree | join: ", " -%}
  {%- endif -%}

  {%- if include.layout == "full" -%}
    <section class="doc-hero">
      <div class="container doc-hero__inner">
        <img class="doc-avatar"
             src="{{ img }}"
             alt="{{ d.name }}"
             loading="lazy"
             onerror="this.src='{{ '/assets/images/site-images/doctor-placeholder.webp' | relative_url }}'">
        <div class="doc-meta">
          <h2 class="doc-title">
            {%- if d.profile_url -%}
              <a href="{{ d.profile_url | relative_url }}">{{ d.name }}</a>
            {%- else -%}
              {{ d.name }}
            {%- endif -%}
          </h2>
          <div class="doc-sub">
            <span>{{ degree_text }}</span>
            <span class="doc-dot">•</span>
            <span>{{ d.speciality }}</span>
            {%- if d.location -%}
              <span class="doc-dot">•</span><span>{{ d.location }}</span>
            {%- endif -%}
          </div>
        </div>
      </div>
    </section>

    {%- if d.bio -%}
      <section class="container doc-sections" style="margin-top:14px;">
        <div class="doc-section">
          <div class="doc-section__head"><h2>About {{ d.name }}</h2></div>
          <div class="doc-section__body">{{ d.bio }}</div>
        </div>

        {%- if d.services -%}
          <div class="doc-section">
            <div class="doc-section__head with-icon">
              <h2>
                 <span class="icon">
                   <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512" aria-hidden="true">
                     <path fill="currentColor" d="M240 24c0-13.3 10.7-24 24-24l48 0c13.3 0 24 10.7 24 24l0 56 56 0c13.3 0 24 10.7 24 24l0 48c0 13.3-10.7 24-24 24l-56 0 0 56c0 13.3-10.7 24-24 24l-48 0c-13.3 0-24-10.7-24-24l0-56-56 0c-13.3 0-24-10.7-24-24l0-48c0-13.3 10.7-24 24-24l56 0 0-56zM66.7 384l42.5-42.5c24-24 56.6-37.5 90.5-37.5L352 304c17.7 0 32 14.3 32 32s-14.3 32-32 32l-72 0c-13.3 0-24 10.7-24 24s10.7 24 24 24l112.6 0 119.7-88.2c17.8-13.1 42.8-9.3 55.9 8.5s9.3 42.8-8.5 55.9L433.1 485.5c-23.4 17.2-51.6 26.5-80.7 26.5L32 512c-17.7 0-32-14.3-32-32l0-64c0-17.7 14.3-32 32-32l34.7 0z"/>
                   </svg>
                 </span>
                 Services
               </h2>
            </div>
            <div class="doc-section__body">
              <ul>
                {%- for s in d.services -%}
                  <li>{{ s }}</li>
                {%- endfor -%}
              </ul>
            </div>
          </div>
        {%- endif -%}
      </section>
    {%- endif -%}

  {%- else -%}
    <div class="doc-card light">
      {%- if d.profile_url -%}
        <a class="doc-card__imglink" href="{{ d.profile_url | relative_url }}">
          <img loading="lazy"
               src="{{ img }}"
               alt="{{ d.name }}"
               onerror="this.src='{{ '/assets/images/site-images/doctor-placeholder.webp' | relative_url }}'">
        </a>
      {%- else -%}
        <img loading="lazy"
             src="{{ img }}"
             alt="{{ d.name }}"
             onerror="this.src='{{ '/assets/images/site-images/doctor-placeholder.webp' | relative_url }}'">
      {%- endif -%}

      <div class="meta">
        <div class="name">
          {%- if d.profile_url -%}
            <a href="{{ d.profile_url | relative_url }}">{{ d.name }}</a>
          {%- else -%}
            {{ d.name }}
          {%- endif -%}
        </div>
        <div class="qual">{{ degree_text }}</div>
        <div class="dept">{{ d.speciality }}</div>
        {%- if d.location -%}
          <div class="loc">{{ d.location }}</div>
        {%- endif -%}
      </div>
    </div>
  {%- endif -%}

{%- else -%}
  <div class="post-item" role="note">
    Doctor not found for id: <code>{{ include.id }}</code>
  </div>
{%- endif -%}


